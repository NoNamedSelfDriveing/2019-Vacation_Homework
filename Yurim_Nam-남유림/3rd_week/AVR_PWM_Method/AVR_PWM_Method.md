# AVR_PWM_Method

타이머를 이용한 PWM 모드는 총 두 가지가 있다. **Fast PWM, Phase Correct PWM** 가 있으며 이에 대하여 알아보도록 하겠다.

## Fast PWM

![](https://t1.daumcdn.net/cfile/tistory/260845405768E5132C)

위의 그림은 Fast PWM 동작 원리를 나타낸 그림이다. 그림을 보면 TCNTn은 0x00부터 0xff까지 증가하다가 다시 0x00으로 값이 뚝 떨어지고 증가하는 과정을 반복하고 있다. <br>
만일 이 과정 중에서 **OCRn의 값과 TCNTn의 값이 같게 되면(비교 매치), OCn핀의 출력값이 바뀌게 된다.** <br>
이 과정에서 어떠한 모드로 설정했느냐에 따라 OCn핀의 출력값이 바뀌게 된다. <br>
**비반전 비교 출력 모드**일 경우, *HIGH가 출력되다가 비교 매치에서 OCn핀에 0이 출력이 된다. TCNTn이 0xff에서 0x00로 값이 떨어질 때 다시 HIGH가 출력*이 된다. <br>
반대로 **반전 비교 출력 모드**일 경우, *LOW가 출력되다가 비교 매치에서 OCn핀에 1이 출력되고 TCNTn이 0xff에서 0x00으로 값이 떨어질 때 다시 LOW가 출력*된다.

## Phase Correct PWM

![](https://mblogthumb-phinf.pstatic.net/20140802_93/ga1267_1406965834222jdjnn_PNG/%C4%B8%C3%B32.PNG?type=w2)

위의 그림은 Phase Correct PWM 동작 원리를 나타낸 그림이다. Fast PWM과는 달리, TCNTn의 값이 뚝 떨어지지 않고 천천히 감소하고 있는 모습을 볼 수 있다. TCNTn의 값이 증가할 때는 **업 카운트**, 감소할 때는 **다운 카운트**라고 한다.<br>
이 모드에서는 **비반전 출력 모드**일 때 *업 카운트 중에 비교 매치에서 OCn 핀에 0이 출력되고, 다운 카운트 중에서는 1이 출력*된다. <br>
반대로 **반전 출력 모드**일 때에는 *업 카운트 중에는 OCn핀에 1이 출력되고, 다운 카운트 중에서는 0이 출력*된다. <br><br>

이 두 모드의 차이는 주파수와 분해능이다. **Fast PWM 모드는 Phase Correct PWM 모드에 비해 주파수가 높고, Phase Correct PWM 모드는 Fast PWM 모드에 비해 분해능이 높다.**

## 레지스터 설정
Fast PWM은 TCCR0 레지스터의 6번 비트와 3번 비트가 11일 때 사용되는 모드이다.

![](data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxIRERUQEBISFRUVFRcQFRgVEB4XFRUXFRUWFhcYFRgYISggGBolGxUVITEhJikrLi4uFyAzODMsOCgtMCsBCgoKDg0NGg0PGzIeHyU3ODg1LCs3Ny8rKzcrLSstLTAtNysuLTgtNys4KysrNzIrKzc2LSsrKystNystLSsrK//AABEIAGcB5wMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABQYBAgQDB//EAEQQAAICAQIDAwkGAwUGBwAAAAECAAMRBBIFEyEGIjEHFBdBUVSRktEjMlJhcYEkQqE0YnOU4TVDU3KzwhUzg6Kx8PH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAwH/xAAZEQEBAQEBAQAAAAAAAAAAAAAAAgESURH/2gAMAwEAAhEDEQA/APuMREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERASu8Q7RtXqWp5YKq1Klu/8A75tuSwQomP7zDMsUjNRwSp7Tc2/J2blFrCtuX1XcgO1sfmPUIHnwDjB1Js+zKhOXg7gd2+tXPTORjdjr/wDkvOLh/Da6M8sEAqqkbiR3BgHB9eMDP5D2TtgIiICIiAicvEeIVaetrr3CVoMszeCjIGT+5Er/AKR+E+/0fMfpAtUjeOa56K+ZWqMchQrMV3MxCoq4B6liB+8h/SRwn3+j5j9J4ant9wezbu11B2sLB3j95fA+HXxgW6onA3YBwM4OQDjrg+ubyqekfhPv9HzH6TPpI4T7/R8x+kC1RKr6SOE+/wBHzH6R6SOE+/0fMfpAtUhtbxvZqRpwq+FbMzFgBzXdFAKqQD3DjcQCSADmR3pI4T7/AEfMfpOHV9tOC2Otj66nK7T0tYK2w7l3gdGAJJAPrgXdZmVQeUfhPv8AR8x+kz6SOE+/0fMfpAtUSq+kjhPv9HzH6R6SOE+/0fMfpAtJkTpuKs2oal6yihilZYMDaVVWJXpgjq3r/lMiz5R+E+/0fMfpOKrtnwVbTcNdTuOT1sYqpbozKp6Kx9ZEC7iZlU9I/Cff6PmP0mfSRwn3+j5j9IFqiVX0kcJ9/o+Y/SPSRwn3+j5j9IFmvtVFLMQFALEnwAHjOLgfEW1FZsas1kWW17S2TiuxkBPsJCg49WcSB1PlA4PYpR9bpmVhtZW6qQfUQRgieHDe2nA9OpSjV6WtSzWEL0G5ySTgCBdolV9JHCff6PmP0j0j8J9/o+Y/SBaolV9JHCff6PmP0j0kcJ9/o+Y/SBPcT1L1oWrQOR1IJPRQCScKGZj06AAkkzPC9Zzqa7sbeYi2YznbuAOMjoceEq2u7d8HtXa2vqGCGBWxlZSPWrLgjoSP0Jnppe3/AAetBWmu04VRgDcegH7dYFwiVX0kcJ9/o+Y/SPSPwn3+j5j9IFqiVX0kcJ9/o+Y/SPSPwn3+j5j9IEtxPiNlToBWrIzImeZh2Z32kIgBztXvHOBgH2STEouq7YcFstW88RUOg2jbqHVcbt2Co6HJ8enUdJIDyj8J9/o+Y/SBa4lV9JHCff6PmP0j0j8J9/o+Y/SBapgmVb0kcJ9/o+Y/SY9I/Cff6PmP0gTmk15e62kpt5YQg7slg+8ZwPD7nt9fqnfKcnb7g4drBrqNzhVY7j1Cbtvq/vGe/pH4T7/R8x+kC1RKr6SOE+/0fMfpHpH4T7/R8x+kC1Ti4xruRS9u3cVAwM4ySQoBPqGSOuJBekjhPv8AR8x+k8Nb294NajVvrqCrDBG8j4EDIP5iBYuE682hwyhWrsalgGyuVCnKkgHBDD1TvlL0Hbrg1K7E19PiWJaxmZmPiWZupP6+ydXpI4T7/R8x+kC1RKr6SOE+/wBHzH6SzUXK6q6HKsAykeBBGQR+0D0iYzMQNomszAzExEDMREBERAREQERECo+Vn/Y+s/wv+9ZB+T7sNw2/hmluu0dL2PSrOzL1YnPU9ZOeVj/Y+s/wv+9ZT+xHlR4dpeH6bTXNcLKqlRwNOxAI8cH1wOztD2R0aaurTafQaXa9fMc+YveR9oE67bU2Lg+Jz4Tjq4FoQVvbQ8PaizUW6VaUrbzhTVzRuLlyGb7IkpsGA3j06y58rfCN/Mzdu27N3mrZ25zjPsz1nLX5S+BLcdStbC5htawaIiwj82xmBHp2f0gpSxtLwlm1C6d6QiP9j5zalYNi7/tkXeO+Cm4jGBmWXs32K4XqNNXdZw/TBm3BtqEKSjMhKgkkA7cjqfHxkNX5Q+z6raq04W/JuA0HS3PjvGO9+879P5XeEVqqIblVQFULpWAAHQAAeAgd/EPJ/wALWzTgaGgBrird3xHm97YPX2qp/acXarsnwrR0rqToNKKlsQXE1k4qbullwehDFT6+mZy67yucMd6GD34rtLt/DN4Gi5On7us9tX5WeD2oa7ea6N0ZW0jFT6+oPjArWm4fpG+yfh3DkuTZXfmt+XU+purXTEnd1HKZmK5yTtGVzM36LQVbN+i4fYK9W9GqddLbVspVFcuEsbKsN+fF1IGQesnn8qHBG5m5XPNAW3OjJ5gUYAfp3gB7Z4V+UPs+tfJWoisBl2DQkLh12uMYx1HQ/lAhNNodKyBn4bw9GBttdTU2WqSyhErTv9LSLwSxyMjGOssHZbsxw/U3WJboNFt2m2vl1sGRRfbSUtJY7m+yByAuMkY6ZmLPKVwJipatiUsN6k6IkrYRguOnRunjPXSeVPglTO9S2I1p32FdGVLsBgFiB1MCQ1HYDhY1lNY0VG1qb2I29CVfThT4+oM3xnj2j7F8Np5FdOh0avqLvN1e2ssifZ2WZKhlLnFZAXIznxnBf5WeGHVVXB79qVXVn+HbOXagr0/9Np76/wAq3Bb0NV4ssRvFX0jMp/UEQI0dmdI7CmvS8ID10vfbZsd6rNlz1FawLFKY5ZLElthYDveMguI+Zqtpr4XoQzUU26VXrbq5pS/ULbhhkLW+4Yx4euWXUeUTgFiJVZSWSrBrVtDlUx4bRjp+09L/ACl8CckujsWznOjJzmvlHPT1p3f06QObhvZ7RW3tWOHaEq66g1LsZWrOmtrqbnPubcG5m4YUYAx1zmTnZfsVwzU6PT6izh+lD2012sFrIUF0BOASSBk+0yPo8qPBEse5FdbLABY66IhnC9FDHGTgT20vlc4PWi11m5UUBVVdKwVQBgAAeAgd/DPJ/wALZrw2hoO24qvd8By6zgdfaT8ZEcR7J6AamyurR8Nrro5PMF6Nus5x/kcMBWB4AlWy2R0meH+VvhiNcWe/v2mxf4ZvDYi//KmY1flN4FbYl1qM9lf/AJbtoizJ/wApIyIEdXwLREredDw7lWai7SLSK256tUbVDl9+GOaiWTaMA/eOOsPo10ZStn4XodyUX2aoCtgBatVltK1kt0BRFY5z0cSzjyk8B5zagVtzXXY1nmJ3sCMEFsZPTpFXlK4EpytbAjrkaI/8MU+z/hgJ+gxAg9Vw3SV5rOg4cz0+cWWOKGFdyacaZtlK8wlHYakDcS2DWehz0vXEPJ9woUWOuhoBFbsO54EKSPXK6vlE7PiuuoU4SpuZWvmHdrcHO5Bjoc+udmv8r3C3qsRXvyyMo/hm8SpAgSlvk94byCa9BpuZy8rurJG/b0yARkZx6xKRw7S8PvtrVOHaELqGqTTHlMWLV7Drgw3DOwMwXw6qc5lm0/lh4UEUF78hQP7M3qE5afKZwJDWVRwai7VY0RHLNueYU6d0tk5x45MCCOh0IpFx0fDs36S3V0VebW7q2RC6o9obZaQA24fZkY9eZz00aR7FrHDuHrmuqhmap8JqzqNPRd/OM1p5wuF6EnpuEsI8onZ8NY4pIa4FbT5ic2AjBDHHXM2t8pHAX3Bq2O8OrZ0RO4WlTYDkdQxRSfbtHsga8N7NaGw6Mtw7Q7L2spsYK2S9S3ZNak91Dygckse9j1ZMzxzsBwtFq2aKgZ1FKHC+Ks4BHj6xI+vyq8FUVqosAq/8sDSMBX3SncH8vdJHT1Tx4v5WeGWCsK9/duqsP8O33UcE/wBIFo9HPCfcNP8AL/rKxxnspoF1FlVOj4bWtFVV9h1CNiwWtYuFZXHLA5ZyxDdWHSd3pk4V+O//ACzTi13lN4FeyPcjWNWd1ZfRFih9qkjpAieI8K0VF2oFnD9CKkS80Dksea1NXMH26uVz0fdWVUgKTk+vdOzunJWsaDhrOt507EUuOeQKXxUnMPLUV2sWsZmANeMd7pIL5SeAi1tQKjzXBR7PMTvZT4hmxkgzmftz2cYVhtOCKsmseYdK8ncdnTp1wYFxHk64T7hp/l/1nFX5P+F+dOnmNG0U1sBt6ZL2gnx9ij4TjHlj4V+O/wDyzTkTyucMGoe3fftNVdY/hmzlXtJ/oy/GBZD5OuE+4af5P9ZT9L2b0bo940XCyrJqGppbdXarUEhQ9jOQ2SO93V259cmPTJwr8d/+WaR6eUngIsstFRFlo2WP5id1inxDnHeH6wIReGaTkkNoeHi9Wdn5mksqCommN+wobD3m2kB1dlxk46Ylm0HZDh9mrFT8N0i1NphqEwrGzJZQd2cADvEYwfDOeuJHp2/7PLVyFoxXvFuzzDubx4NjGN35yQ9LfB9/Mzdu27N3mrZ25ztz7M9cQJ30c8J9w0/yf6yP4F2A4W9RZ9DQTztQuSvqTUWqo8fUAB+05/TJwr8d/wDlmnDwfytcMqrKs9+Tbe/TTt4WX2Ov/tYQJTtH2L4XptO1q8P0xbclY3Kdimyxawz4P3RuyfyBld4p2Wopq2rouGXWi81O9VDNsr5PMydNzQ5fJUEBzhWDY9UmbvK9wh1KObmVgVIOlYgg+III6iRjdvuzppGmOnHJDbxX/wCH9wN7QuMZ/OBEa+rh1a89eH6Cynl/dWtw7P5jbrOYrMwxX9ns2lM9Sc9MS2dmOxXDrksW/Q6JrKrTSz1VMtb9xLAVVmYjo4B6nqM+vA4h5TeB7xbsbeqckN5idwrP8gOPu/lPXh/lU4Lp6xVQLKq1zhE0bKoycnAAx4kwInyydj9BpOFvdptLVVYLK1DKuCAWwRPp/Zz+x6f/AAKv+ms+P+Vbyi6HX8OfTaZrTYXrYBqGUYVsnqZ9g7N/2PT/AOBV/wBNYFV7fcQ1dV9K6a5EWwpUQ1bNgtzDuG2xfUoGP6yDr7R6rcXN1fLFltHLLstzNUrElDuIJJTITH3TnM+g8W4EuodXY/dwV7gOGG7DDPge8ZHjsZQLOf3ebjG/krvx7N3jK5s/Eamt1RNV2o1yUc3n0uzih61QuzKL7krIKb82YDdGBXJ9Qng/bLWivdvXKi+0kh13pp+WCgr5hNVhZ2HUnGzOOuJf6uw2mTIRa13MHbFCjLK25WOPEggEH2iZt7E0McsEY7xbk0qe+AAH6/zYAGfyE3qTmvFj0jZRSfWoP9BE2pr2qF9gA+ESKr0lQ45xO9L7gj2haxpwpAq5FZsLbmv3DmbOgyV8B7PGW+aMgOeg69D+f6w1U17UWkvuWtBuatNxUsrLaawHUW5OQCctywCMdcici9rrXWmwtVWC9O9cZexX3FzXliAvdx6/X3unW6mhevdXr49B1x4Z9sGhPWq9PDoOkCmnjmopJ59n9nxrNR3B/Z7VUBSAOgUm8jHU+bDJ6nKzjWrWpwzIHTFZ+zy4sbRHUEnrjAYhQMfy+MunLHXoOvQ9PH9Y2D2D2+H7QKz2d4/dfYK3Fe0AqTuUOSir3wu8sVbdn7oABHU5lpnmtKg5AA6Y6D1DwH6T0gYKgzXlL7B8JvEDQ1L+EfCVnjupuS/kUlQ1tYtpygODSWa4Hp91hyV9Z+0OPCWmalR4wIrs9qOfVzz1Wx2esFAMVZ2p0xnBC7uvXvftJTlL+EfCZRQOgm0DTlL+EfCOUv4R8JvECC7S2Oh061B/tL+WwqFe9lFF74Bt7o6op/aQicZtFIvZwEozdqAyLvFZvK7LtowtiVJYWC47w8ceN2Zc/tNeWOvQdfHp4/r7YFX4BrL31HIubJrRtRZ9kFBXUFTQucfy4uTp48rqSc5tPKX8I+EyEHj+02gacpfwj4Ryl/CPhN4gVTtLrLK7XFYu2pp+bilajhi7Dc4sG4qAPBc9AenhOe7id3dYOhW0+ZoUrDLzyle21Dg5TfzvE4wBLiUHj+01FajAAGB1HTw/SBC9nNQ93MazB2FdPjlhRzKwecw6Z6s2PEjudPXJvlL+EfCZVAPD9ZtA05S+wfCDUv4R8JvEClHitiWhrDaK/OL0LMtXIKVb8VptHM5hwMZxkqep6ArOJX1MUtYZpC627Fan7AoiunRfU/OII6/ZiXI1jwwPb4f1jYPYPZ4eqBw8DVmora4Auyh26DoX720YA6AED9p3cpfwj4TYCZgacpfwj4Th44/L011iYDJVY6naDgqhIOD0PUSRmGXPQwKfTrbt70ZtRmFKJzlqNmXJL218oFSgQN457y+AHjy08Z1DbOoHMZdB0qB26mtlN7gkeG3nDr0+xGB1l4NYzn1joPyjlj2Dxz4ev2wHKX2D4Ryl/CPhNxEDTlL7B8JD9o3ZBUKt4L3BCKxXvK7HYgG3uj7o+Em5qy5gUevjVorW5mwtLNbqAyLvFRu5YS7auBYiixjtx1QdSDJPgOpue/k3HJrrNtn2YGeeUakDA8FHOTp17gz+dj5Q69B18enj+vtmwQeP/wB6QMcpfwj4Ryl/CPhN4gacpfwj4Sn8c19yX3hDaFrWjaQtXJrNm7L37hzNnQbiucAHw8Zc5oax16ePQ9PH9YFS1evuLBKmA85Lppzy1ITkvhmHTrur3OM9OklezWqOora9h3XcitSgG1UVUYeHU8xbOvX1Y6SYFY6dB08Onh+kyqAeEDHKX8I+Ecpfwj4TeIHmal9g+EpOn4tcu1mNneS5hzVq5dpBK1rRyxu3BtvRsHbk4PqvRmhqHToOnUdPCBSruL30Fw7bxpSRdmpftRd/Z87V6YyPu4/MdRLdodOVrQWYZwqh2KjvNjqegA8c+Anvyx16Dr49JvA05S/hHwmwEzEBERAREQEREBKrxKzU+dslT2IjPSpYV7wq8jVO23cCoy61AnHsHrlqjED59RrdY712vzlzW2UCEIXb/wAPbwIyCN1+OvTa396e+g4nq7dZUjc7lb67MmvbjmUa3cjlVC4Vkp7pLYYjLHIl5xGIFc1LXJY9Y5rIhbWBlyxZdpIpByNx5uSFz90AeBkFXxbWm3P2pWt9u7lHDVM2gLlsIqsQr6jBA6YbqSDPoGIxApmk4vrHuA+7XzWC76mXmJ5zYmMCsnpWqEHcv3txJEugmMTMBERASB7UE5rybRXiwsaiwbeEzXnl97x3dPAnH5SemMQOfhxflV837+xd/wDzbRu/rmdMRAREQErHG2s85G03A/w3KCFthzewv3gd0jYFzu8B4YlnmMQCzMRAREQMGVnQs/nZybsl7hYCX5QrATlFQe4P5cY8cv44OLOZjEAJmIgIiIHBx1rBprTTnmct9mPHO04x+c5ezv8AvgpsNQtApNjMzFeVXu71neI5nM8fz9UmMQFgZiIgIiIEP2hzirJcVm0C4ozBgmx8da+8BzOXnHq/Ke/Z5nOmpNu7fy1Lb/v5x/N/e9v5yQxAEDMREBERAq3HWt85G02jC0ckKWCFzqCLtwXofs9n3vAeHrloWMTMBERATDTMwRArXAWs55ybuq284OXKiwX4rCBu6Bs3/d6Y2/lLNMATMBERASM7Rs401nK3btv8ud2Nw3bcdc7d3h1knECI7NltlmS5QWuKS5Ysa+7jJfvEbt+CfVj1YkvMATMBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQP//Z)

6번 비트와 3번 비트는 PWM의 모드를 결정한다. 만일 **10일 시 Phase Correct PWM 모드**가 되고, **11일 시 Fast PWM 모드**가 된다. 또한 PWM 기능을 사용할 때는 5번 비트와 4번 비트를 사용함으로서 **반전 출력 모드인지, 비반전 출력 모드인지를 설정**해줘야 한다. <br>

Fast PWM
| COM01 | COM00 | Voltage Reference Selection                         |
| ----- | ----- | --------------------------------------------------- |
| 0     | 0     | OCn 차단                                             |
| 0     | 1     | -                                                   |
| 1     | 0     | 비반전 출력 모드                                      |
| 1     | 1     | 반전 출력 모드                                        |


Phase Correct PWM
| COM01 | COM00 | Voltage Reference Selection                         |
| ----- | ----- | --------------------------------------------------- |
| 0     | 0     | OCn 차단                                             |
| 0     | 1     | -                                                   |
| 1     | 0     | 비반전 출력 모드                                      |
| 1     | 1     | 반전 출력 모드                                        |